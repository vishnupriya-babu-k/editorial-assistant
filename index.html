function fixText() {
    // Get the input text
    let text = document.getElementById('inputText').value;
    
    // Split into paragraphs (any number of line breaks)
    let paragraphs = text.split(/\r?\n\r?\n+/);
    
    // Process each paragraph separately
    let fixedParagraphs = paragraphs.map(paragraph => {
        if (!paragraph.trim()) return ''; // Skip empty paragraphs
        
        let fixed = paragraph.trim();
        
        // Fix multiple spaces
        fixed = fixed.replace(/ +/g, ' ');
        
        // Fix periods and commas with no space before and ensure space after
        fixed = fixed.replace(/(\w)([.,])(\w)/g, '$1$2 $3');  // word[.,]word → word[.,] word
        fixed = fixed.replace(/\s+([.,])(\w)/g, '$1 $2');     // word [.,]word → word[.,] word
        fixed = fixed.replace(/(\w)([.,])\s+/g, '$1$2 ');     // word[.,] word → word[.,] word
        
        // Fix spaces before punctuation
        fixed = fixed.replace(/\s+([.,!?:;])/g, '$1');
        
        // Fix spaces after punctuation
        fixed = fixed.replace(/([.,!?:;])(\w)/g, '$1 $2');
        
        // Fix missing spaces after commas
        fixed = fixed.replace(/,(\w)/g, ', $1');
        
        // Fix spaces around quotation marks
        fixed = fixed.replace(/"\s+/g, '"');
        fixed = fixed.replace(/\s+"/g, '"');
        fixed = fixed.replace(/'\s+/g, "'");
        fixed = fixed.replace(/\s+'/g, "'");
        
        // Fix spacing around parentheses
        fixed = fixed.replace(/\s+\)/g, ')');
        fixed = fixed.replace(/\(\s+/g, '(');
        
        // Fix multiple consecutive punctuation marks
        fixed = fixed.replace(/([.,!?:;]){2,}/g, '$1');
        
        // Ensure single space after periods
        fixed = fixed.replace(/\.\s+/g, '. ');
        
        // Fix capitalization after periods (including when period is right next to the word)
        fixed = fixed.replace(/\.(\s*)([a-z])/g, (match, space, letter) => '. ' + letter.toUpperCase());
        
        // Fix capitalization at the start of paragraph
        fixed = fixed.charAt(0).toUpperCase() + fixed.slice(1);
        
        return fixed;
    });
    
    // Join paragraphs with exactly one blank line and remove any empty paragraphs
    let result = fixedParagraphs
        .filter(para => para.length > 0)  // Remove empty paragraphs
        .join('\n\n');     // Join with exactly one blank line
        
    // Final cleanup to ensure no multiple line breaks anywhere
    result = result
        .replace(/\n{3,}/g, '\n\n')  // Replace multiple line breaks with double line break
        .trim();                      // Remove any trailing whitespace
    
    // Update output
    document.getElementById('outputText').value = result;
}
